Habilidades e magias (cmd/ataque.int e adm/ataque.int)

Habilidades são definidas como a maioria dos comandos do MUD: uma classe
cujo nome é "cmd_" seguido do nome da habilidade.
Magias são classes cujo nome é "magia_" seguido do nome da magia.

Via de regra, habilidades e magias são colocadas no arquivo config/hab.int.
Todas elas herdam, diretamente ou indiretamente, a classe comando_hab.

Podem ser dos seguintes tipos:
Comuns: herdam comando_ataque
De identificação: herdam comando_identificar
De retorno: herdam comando_retornar

Na classe comando_hab:

const posic = 7
Posição mínima do personagem para usar a hab/magia.

const precisao = 100
Precisão do golpe, maior que 100 nunca falha.

const tipoarma = 0
É um valor numérico em que cada bit corresponde a um tipo de arma
da lista em config:arma_txt, no arquivo config/config.int.
Se for 0, funciona independente da arma usada.
Nota: é muito mais fácil alterar essa constante pela edição online.

const valor = 0
Preço da aula: quantas moedas os personagens cobram para ensinar.

const depende = ""
Habilidades, magias e idiomas necessários para aprender esse ataque.
É um texto em que cada linha contém o nome de uma prática, no formato:
Habilidades são "h_" seguido do nome da habilida
Magias são "m_" seguido do nome da magia
Idiomas são "i_" seguido do nome do idioma
Exemplo:
const depende = "h_chutar\nm_voar"

const aulaini = 0
Iniciante nível: a partir de que nível pode ter a primeira aula.

const aulafim = 0
Perito nível: A partir de que nível pode ter todas as aulas

const tipoperso = ""
Raças e classes de personagens que podem aprender essa hab/magia.
É um texto sendo que cada linha é uma raça ou classe.
Se estiver vazio, todas as classes e raças podem aprender.
Exemplo:
const tipoperso = "anão\nguerreiro"

const c_espera = 15
Tempo de espera: tempo mínimo que deve esperar, em décimos de segundo

const c_vida1 = 0
Quantos pontos de vida consome no nível iniciante.

const c_vida2 = 0
Quantos pontos de vida consome no nível perito.

const c_mana1 = 0
Quantos pontos de mana consome no nível iniciante.

const c_mana2 = 0
Quantos pontos de mana consome no nível perito.

const c_move1 = 0
Quantos pontos de vigor consome no nível iniciante.

const c_move2 = 0
Quantos pontos de vigor consome no nível perito.

const a_cond = 0
Condição para aplicar os efeitos sob o alvo:
0 = Um ou mais pontos de vida
1 = Nenhum ponto de vida
2 = Nenhuma condição

const a_vida1 = 0
Quantos pontos de vida ganha.

const a_vida2 = 0
Quantos pontos de vida ganha por nível.

const a_mana1 = 0
Quantos pontos de mana ganha.

const a_mana2 = 0
Quantos pontos de mana ganha por nível.

const a_move1 = 0
Quantos pontos de vigor ganha.

const a_move2 = 0
Quantos pontos de vigor ganha por nível.

const a_efeito1 = ""
Nome do primeiro efeito aplicado sob o alvo.

const a_prob1 = 100
Probabilidade de criar o primeiro efeito, 100=não falha.

const a_efeito2 = ""
Nome do segundo efeito aplicado sob o alvo.

const a_prob2 = 100
Probabilidade de criar o segundo efeito, 100=não falha.

const a_efeito3 = ""
Nome do terceiro efeito aplicado sob o alvo.

const a_prob3 = 100
Probabilidade de criar o terceiro efeito, 100=não falha.

const a_remove = ""
Nomes dos efeitos que serão removidos.
É um texto sendo que cada linha é o nome de um efeito.
Exemplo:
const a_remove = "flutuar"

func checahab1( personagem )
func checahab2( personagem, quanto sabe )
Checa se personagem pode usar habilidade/magia e avisa o personagem.
O argumento quanto sabe é um número de 0 a 1 que indica quanto sabe da
habilidade ou magia (0=iniciante até 1=perito).
Retorna verdadeiro se puder usar (na prática, 0=falso, 1=verdadeiro).

func autohab1( personagem )
func autohab2( personagem, quanto sabe )
Mesmo que checahab (acima), exceto que não avisa o personagem.

func custohab1( personagem )
func custohab2( personagem, quanto sabe )
Aplica os custos da habilidade/magia, como gasto de mana e de moviemnto.
Argumento quanto sabe, vide função checahab2, acima.

Na classe comando_ataque:

const tipoalvo = 0
Indica o tipo de alvo e de hab/magia:
0 = Qualquer um; ataque
1 = Exceto o personagem; ataque
2 = Todos dividindo o ataque
3 = Outros dividindo o ataque
4 = Todos sem dividir o ataque
5 = Outros sem dividir o ataque
6 = Qualquer um; não é ataque
7 = O personagem; não é ataque
8 = Ataque automático
9 = Nenhum (não ataca)

const a_batalha = 0
Condição:
0 = Nenhuma
1 = Durante a batalha
2 = Fora da batalha

const tipoatk = 0
Elemento usado no ataque, como contusão, cortante, fogo, etc. Os elementos
estão definidos na constante config:atknomes, arquivo config/config.int.
Nota: é muito mais fácil alterar essa constante pela edição online.

const ataque = 50
Força de ataque, em porcentagem (100 significa 100%).

const vel = 50
Velocidade do golpe, em porcentagem (100 significa 100%).

const tipobonus = ""
Raças e classes de personagens que possuem um bônus (atacam com mais força).
É um texto sendo que cada linha é uma raça ou classe.
Exemplo:
const tipobonus = "anão\nguerreiro"

const msgextra = ""
Informações extras, mostradas quando o jogador consulta sobre a hab/magia.

const msgatk0 = ""
Variáveis msgatk0 a msgatk4. Contém várias linhas de texto, sendo que cada
linha é uma mensagem de batalha.
Ao usar a habilidade ou magia:
Linha 0 = para o personagem
Linha 1 = para o alvo; se vazio assume linha 0
Linha 2 = para os outros; se vazio assume linha 0
Quando acertou o golpe em si mesmo:
Linha 3 = para o personagem
Linha 4 = para os outros; se vazio assume linha 3
Quando acertou outro personagem:
Linha 5 = para o personagem
Linha 6 = para o alvo; se vazio assume linha 5
Linha 7 = para os outros; se vazio assume linha 5
Quando matou o alvo:
Linha 8 = para o personagem
Linha 9 = para o alvo; se vazio assume linha 8
Linha 10 = para os outros; se vazio assume linha 8
Quando errou o alvo:
Linha 11 = para o personagem
Linha 12 = para o alvo; se vazio assume linha 11
Linha 13 = para os outros; se vazio assume linha 11
Quando o golpe não teve efeito:
Linha 14 = para o personagem
Linha 15 = para o alvo; se vazio assume linha 14
Linha 16 = para os outros; se vazio assume linha 14

func habajuda
arg0 = objeto do personagem, ou nulo se está pedindo informações sobre a aula
Retorna um texto que contém informações, para os comandos hab, magia e
quando o jogador pede informações sobre uma aula.

func escr( personagem, o que escreveu, item, nível )
É chamado quando o jogador digita o comando para usar a hab/magia.
Essa função basicamente obtém o alvo e chama a função exechab.
O argumento é o item que disparou a hab/magia (uma comida, bebida
ou pergaminho), ou nulo se não usou nenhum.
O argumento nível é o nível da hab/magia, quando o item não for nulo.

func exechabperso( personagem, alvo )
Personagem usa uma habilidade ou magia. É uma versão simplificada de exechab.

func exechab( personagem, alvo, quanto sabe, nível, item usado )
Chamado quando personagem usa habilidade ou magia.
O argumento quanto sabe é um número de 0 a 1 que indica quanto sabe da
habilidade ou magia (0=iniciante até 1=perito).
O argumento nível geralmente é o nível do personagem.
O argumento item é o item que disparou a hab/magia (uma comida, bebida
ou pergaminho), ou nulo se não usou nenhum.

func efeitohab( personagem, alvo, quanto sabe, nível )
Aplica o efeito da habilidade ou magia sobre o alvo.
Os argumento quanto sabe, e nível, vide função exechab, acima.

func velgolpe( personagem, alvo )
Acerta o tempo de espera conforme o golpe.
Se baseia na constante vel da hag/magia, que é a velocidade do golpe.

func execgolpe( personagem, alvo, força do ataque )
Realiza um ataque e coloca resultado em result e mudavida.
Na força do ataque deve estar incluído o quanto sabe do golpe.
Se for 0, não calcula os danos.
Se baseia em tipoatk (tipo de ataque) e arma1 (arma usada)

func mensgolpe( personagem, alvo )
Envia mensagens de alvo principal de acordo com o resultado do ataque.
Faz result=10 se o alvo morreu, mas não chama a função morreu.

func mensgolpe2( personagem, alvo )
Envia mensagens de alvo secundário (não envia todas as mensagens)
de acordo com o resultado do ataque.
Faz result=10 se o alvo morreu, mas não chama a função morreu.
